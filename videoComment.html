<!DOCTYPE html>
<!-- saved from url=(0058)file:///C:/Users/TASH/Desktop/videos-pack/mobile/test.html -->
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Video Page</title>
		<link rel="stylesheet" href="themes/Black_MC.min.css" />
		<link rel="stylesheet" href="themes/jquery.mobile.icons.min.css" />
		<link rel="stylesheet" href="jquerymobile/jquery.mobile.structure-1.4.2.min.css" />
        <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
        <script src="js/jqm.page.params.js"></script> 
		<script src="jquerymobile/jquery-1.11.0.min.js"></script>
        <script src="jquerymobile/jquery.mobile-1.4.2.min.js"></script> 
		
		<style>
			.vendor {
				margin-top: 0px;
				border:groove;
				padding: 1%;
				/*background-color: lightgrey;*/
				
			}
			.inputComments {
				width: 100%;
			}
			a:hover img
			{
				box-shadow: 4px 4px 10px #000000;
				background:rgba(0,0,0,.75);
              	opacity:0.75;
               -webkit-transition: opacity .25s ease;
			}
			.lh1
			{
				margin-left:auto;
			}
			#commentcontainer
			{
	border-bottom-width: 1px;
	border-bottom-style: solid;
	border-bottom-color: #666;
	opacity: 0.9;
	padding-top: 9px;
	padding-bottom: 9px;
	margin-right: 12px;
	margin-left: 12px;
	font-size: 13px;
			}
			#commentemailcontainer
			{
				opacity: 0.5;
			padding-top: 5px;	
	font-size: 11px;				
			}
			.navcontainer
			{
	
			background-color: #333;	
			 
			}
			#vTitle
			{
	padding-top: 12px;
	padding-right: 9px;
	padding-bottom: 9px;
	padding-left: 9px;
	font-size: 30px;
			}
			#videoDescription
			{
	padding-top: 0px;
	padding-right: 9px;
	padding-bottom: 9px;
	padding-left: 9px;
	font-size: 12px;
			}
			.rateup_button
			{
				background-image: url(/images/buttons/add.png); /* 16px x 16px */
    background-color: transparent; /* make the button transparent */
    background-repeat: no-repeat;  /* make the background image appear only once */
    background-position: 0px 0px;  /* equivalent to 'top left' */
    border: none;           /* assuming we don't want any borders */
    cursor: pointer;        /* make the cursor like hovering over an <a> element */
    height: 16px;           /* make this the size of your image */
    padding-left: 16px;     /* make text start to the right of the image */
    vertical-align: middle; /* align the text vertically centered */
			}
			.ratecontainer
			{
				padding-top: 10px;
	padding-right: 9px;
	
	padding-left: 9px;
			}
        </style>
	</head>
	<body>
    <div class="screen">
    <div data-role="page">
        <!--HEADER START -->
		<div data-role="header" data-position="fixed">
			<a href="" class="ui-btn ui-shadow ui-corner-all ui-icon-arrow-l ui-btn-icon-notext" onclick="goBack()"/></a> 
			<h1 class="lh1" id="videoTitle"></h1>
			<a href="" class="ui-btn-right ui-btn ui-btn-inline ui-mini ui-corner-all ui-btn-icon-right ui-icon-gear" onclick="window.location.href ='UserSetting.html'">Options</a> 
      	</div>
        <!--HEADER END -->
<div class="iv" id="imageClick">
				</div>
<!--content start -->
	<div data-role="content" data-theme="a" >
    
	 	<div >
        	<div >
        		<!--<iframe title="Video Title" height="349" width="100%" src="http://www.youtube.com/embed/29kERg4T9Vc" frameborder="0" 
            	allowfullscreen=""></iframe><br /> 
            	-->
            	
            	
            </div>
    	</div>
        <!--NAV START -->
        
        <div data-role="tabs" id="tabs" >
  <div data-role="navbar">
    <ul>
      <li><a href="#Description_Nav" data-ajax="false">Description</a></li>
      
      <li><a href="#Comments_Nav" data-ajax="false">Comment</a></li>
    </ul>
  </div>
  <div class="navcontainer">
  <div id="Description_Nav">
  	<div id="vTitle"></div>
   		<div id="videoDescription"></div>
        <div class="ratecontainer">
        <form>
						<input id="videoIDR" type="hidden" name="videoID" value="">
						<input id="emailR" type="hidden" name="email" value="">
						<table>
							<tr>
                            <td>
                            <a href="" id="rateUp" class="ratebutton"><img width="20px" src="image\thumbs-up.png"/></a>
                            </td>
                            <td><label id="like" style="font-size: 16px;" value="0"></label></td>
                            <td>
                            <a href="" id="rateDown" class="ratebutton"><img width="20px" src="image\thumbs-down.png"/></a>
                            </td>
									
							<td><label id="dislike" style="font-size: 16px;" value="0"></label></td>	
							
								
                              
								
							</tr>
						</table>
					</form>
                    </div><!-- rating -->
    
  </div>
  <div id="Rating_Nav">
   <div>
    		<div>
		    	<div>
					
			  	</div>
		  	</div>
	  	</div>
  </div>
  <div id="Comments_Nav">
   <form style="margin-top:-18px; background-color: dimgray;"><hr />
	      <textarea class="inputComments" id="comment" name="comment" placeholder="Enter comment here"></textarea>
		  <input id="videoID" type="hidden" name="videoID" value="">
		  <input id="email" type="hidden" name="email" value="">
		  <input id="pd" type="hidden" name="pd" value="">
	      <input type="button" id="btnComment" name="btnComment" value="Comment">
	    </form>
  </div>
</div>
        </div>
    	<!--NAV END -->
        
    	
	  	
    	
	    
	     <div>
         <div style="padding:10px; font-size:20px">Comments
         </div>
			<div id=returnValue>
			</div>
		</div>
</div><!--content END -->

  
		<script>
		  // START GET JSON
			var parameters = location.search.substring(4);

			var videoURL = [];
			var videoT = [];
			var videoD = [];
			var videoComments = [];
			
			var mtaJSONVideos;
			var mtaJSONComments;
			var mtaJSONRatings;
			
			var commentList = "";
		   	var numLike = 0;
		   	var numDislike = 0;
			
		   	var videoID = parameters;
		   	var vote = false;
		   	
			$(document).ready(function() {
					var xmlhttpVideos;
					var xmlhttpComments;
					var xmlhttpRatings;
					if (window.XMLHttpRequest)
					{
						// code for IE7+, Firefox, Chrome, Opera, Safari
						xmlhttpVideos=new XMLHttpRequest();
						xmlhttpComments=new XMLHttpRequest();
						xmlhttpRatings=new XMLHttpRequest();
					}
					else
					{
						// code for IE6, IE5
						xmlhttpVideos=new ActiveXObject("Microsoft.XMLHTTP");
						xmlhttpComments=new ActiveXObject("Microsoft.XMLHTTP");
						xmlhttpRatings=new ActiveXObject("Microsoft.XMLHTTP");
					}
				
					//Video Table
					xmlhttpVideos.open("GET","http://remoteriver.eicp.net/trailercollection/videoinfo.php",true);
					xmlhttpVideos.send();
					xmlhttpVideos.onreadystatechange=function()
			  		{
			  			if (xmlhttpVideos.readyState==4 || xmlhttpVideos.status==200)
					    {
							var getJSON=xmlhttpVideos.responseText;
						
							mtaJSONVideos=jQuery.parseJSON(getJSON);
							
							for(var i=0;i<mtaJSONVideos.videos.length-1;i++)
							{
								videoURL[i+1] = mtaJSONVideos.videos[i].url;
								videoT[i+1] = mtaJSONVideos.videos[i].title;
								videoD[i+1] = mtaJSONVideos.videos[i].description;
							}//get video ids
					  	}
					  
						//video player
						var baseUrl = videoURL[videoID];
						var finalUrl = "videoPlayer.html?id=" + baseUrl;
				
						//Passing data to form - form to comment database
						document.getElementById("email").value="abc@abc.com";
						document.getElementById("videoID").value=mtaJSONVideos.videos[videoID-1].video_id;
						document.getElementById("emailR").value="abc@abc.com";
						document.getElementById("videoIDR").value=mtaJSONVideos.videos[videoID-1].video_id;
						
						//Image Link for videos
						document.getElementById("imageClick").innerHTML="<a href='"+finalUrl+"'><img src='image/imageVP/"+videoID+".jpg' width='100%' height='240px'></a>";	 	
					  	document.getElementById("videoTitle").innerHTML=videoT[videoID];
						document.getElementById("vTitle").innerHTML=videoT[videoID];
					  	document.getElementById("videoDescription").innerHTML=videoD[videoID];
					}		    
				
				
					//Comment Table
					xmlhttpComments.open("GET","http://remoteriver.eicp.net/trailercollection/getComments.php",true);
					xmlhttpComments.send();
					xmlhttpComments.onreadystatechange=function()
					{
						if (xmlhttpComments.readyState==4 && xmlhttpComments.status==200)
					    {
							var getJSON=xmlhttpComments.responseText;
							
							mtaJSONComments=jQuery.parseJSON(getJSON);
							
							
							for(var i=0;i<mtaJSONComments.comments.length-1;i++)
							{
								videoComments[i+1] = mtaJSONComments.comments[i].comment;
							}//get comment
					  	}
					  	
					  	//Looping Comments
					  	for(var i = 0; i < videoComments.length-1;i++)
					  	{
					  		if(mtaJSONComments.comments[i].video_id == videoID)
					  		{
					  		commentList = commentList + "<div id='commentcontainer'>"+videoComments[i+1]+"<br><div id='commentemailcontainer'> <table width='100%'><tr><td>"+mtaJSONComments.comments[i].email+"</td><td  align='right'>"+"</td></tr></table></div></div>";
		    				document.getElementById('returnValue').innerHTML = commentList;
		    				}
					  	}
					}
					
				
					//Rating Table
					xmlhttpRatings.open("GET","http://remoteriver.eicp.net/trailercollection/getRating.php",true);
					xmlhttpRatings.send();
					var countRU = 0;
					var countRD = 0;
					xmlhttpRatings.onreadystatechange=function()
					{
						if (xmlhttpRatings.readyState==4 && xmlhttpRatings.status==200)
					    {
							var getJSON=xmlhttpRatings.responseText;
							
							mtaJSONRatings=jQuery.parseJSON(getJSON);
							
							for(var i = 0;i < mtaJSONRatings.rate.length-1;i++)
							{
								if((mtaJSONRatings.rate[i].email == "abc@abc.com") && (mtaJSONRatings.rate[i].video_id == videoID))
								{
									document.getElementById('rateUp').disabled = true;
									document.getElementById('rateDown').disabled = true;
								}
								if((mtaJSONRatings.rate[i].rating == 1)&&(mtaJSONRatings.rate[i].video_id == videoID))
								{
									countRU++;
								}
								else if((mtaJSONRatings.rate[i].rating == 0)&&(mtaJSONRatings.rate[i].video_id == videoID))
								{
									countRD++;
								}
							}
					  	}
						numLike = countRU;
						numDislike = countRD;
						document.getElementById('like').innerHTML = numLike;
					  	document.getElementById('dislike').innerHTML = numDislike;
						
					}
					
				}
			);
		//END GET JSON
		
		
		//START SCRIPT FUNCTIONS
		
	    	document.getElementById('like').style.color = "Green";
			document.getElementById('dislike').style.color = "Red";
						
		    $(document).ready(function(){
           	  $("#btnComment").click(function(){
           	  document.getElementById('btnComment').disabled = true;
	          var co = $('#comment').val();
			  var vID = $('#videoID').val();
			  var em = $('#email').val();
			  var po = "1111-00-00 00:00:00";
			  var xmlhttp;
			  
			  if (window.XMLHttpRequest)
			  {// code for IE7+, Firefox, Chrome, Opera, Safari
			     xmlhttp=new XMLHttpRequest();
			  }
			  else
			  {// code for IE6, IE5
			  	xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
			  }
			  
			  xmlhttp.open("POST","http://remoteriver.eicp.net/trailercollection/comment.php",true);
			  xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
			  xmlhttp.send("comment="+co+"&videoID="+vID+"&email="+em+"&pd="+po);
			         
			   xmlhttp.onreadystatechange=function()
			   {
			  		if (xmlhttp.readyState==4 && xmlhttp.status==200)
			    	{
			    		window.location = document.URL;
			    	}
			  	}
				});
            });
            
            
           	$(document).ready(function(){
           	  $("#rateUp").click(function(){
           	  document.getElementById('rateUp').disabled = true;
			  document.getElementById('rateDown').disabled = true;
	          var vID = $('#videoIDR').val();
	    	  var em = $('#emailR').val();
			  var ra = 1;
			  var xmlhttp;
			  
			  if (window.XMLHttpRequest)
			  {// code for IE7+, Firefox, Chrome, Opera, Safari
			     xmlhttp=new XMLHttpRequest();
			  }
			  else
			  {// code for IE6, IE5
			  	xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
			  }
			  
			  xmlhttp.open("POST","http://remoteriver.eicp.net/trailercollection/rating.php",true);
			  xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
			  xmlhttp.send("rt="+ra+"&videoID="+vID+"&email="+em);
			           
			   xmlhttp.onreadystatechange=function()
			   {
			  		if (xmlhttp.readyState==4 && xmlhttp.status==200)
			    	{
			    		window.location = document.URL;
			    	}
			  	}
				reloadPage();
				});
            });
			
			$(document).ready(function(){
           	  $("#rateDown").click(function(){
           	  document.getElementById('rateUp').disabled = true;
			  document.getElementById('rateDown').disabled = true;
	          var vID = $('#videoIDR').val();
	    	  var em = $('#emailR').val();
			  var ra = 0;
			  var xmlhttp;
			  
			  if (window.XMLHttpRequest)
			  {// code for IE7+, Firefox, Chrome, Opera, Safari
			     xmlhttp=new XMLHttpRequest();
			  }
			  else
			  {// code for IE6, IE5
			  	xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
			  }
			  
			  xmlhttp.open("POST","http://remoteriver.eicp.net/trailercollection/rating.php",true);
			  xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
			  xmlhttp.send("rt="+ra+"&videoID="+vID+"&email="+em);
			           
			   xmlhttp.onreadystatechange=function()
			   {
			  		if (xmlhttp.readyState==4 && xmlhttp.status==200)
			    	{
			    		window.location = document.URL;
			    	}
			  	}
				reloadPage();
				});
            });
			

		   
		    function goBack()
            {
              window.history.back()
            }
            
			
        //END SCRIPT FUNCTIONS
	    </script>
	    </div><!-- page div -->
        </div><!-- screen -->
	</body>
</html>
