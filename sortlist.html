<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Login Page</title>
		<link rel="stylesheet" href="themes/Black_MC.min.css" />
		<link rel="stylesheet" href="themes/jquery.mobile.icons.min.css" />
		<link rel="stylesheet" href="jquerymobile/jquery.mobile.structure-1.4.2.min.css" />
        <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
        <script src="js/jqm.page.params.js"></script> 
		<script src="jquerymobile/jquery-1.11.0.min.js"></script>
        <script src="jquerymobile/jquery.mobile-1.4.2.min.js"></script> 
	  	<script type="text/javascript">
		    $(document).bind("mobileinit", function() {
		        $.support.cors = true;
		        $.mobile.allowCrossDomainPages = true;
		    });

            // Listener that will invoke the onDeviceReady() function as soon as phonegap has loaded properly
		    document.addEventListener("deviceready", onDeviceReady, false);
			
            // Adding the back button listener
            function onDeviceReady() 
            {
		        navigator.splashscreen.hide();
		        document.addEventListener("backbutton", onBackClickEvent, false); 
		    }

	        function goTo(url)
            {
	            window.location.href=url+"";
	        }
            
            // Back button
            function goBack()
            {
                window.history.back();
            }
		</script>
        <style>
		.videolistitem table
		{
			width:100%;
		}
		.videolistitem .tdimage
		{
			width:107px;
			
		}
		.videolistitem
		{
	border-bottom-width: 1px;
	border-bottom-style: solid;
	border-bottom-color: #555;		
	height:155px;	
		}
		.videolistitem:hover
		{
			opacity:0.4;
		}
		.videolistitemimage
		{
			
			
		}
		.videolistitemtext
		{
			margin-left:4px;
		}
		.videolistitemtitle
		{
			
			 
			 font-size:22px;
			 margin-bottom:6px;
			 
			 
			 
		}
		.videolistitemtitle a
		{
			text-decoration:none;
			
			
		}
		
		.videolistitemdesc
		{
			
			
			height:100px;
		}
		
		
		</style>
	</head>
	<body>
        <!--HEADER START -->
		<div data-role="header" data-position="fixed">
			<a href="" class="ui-btn ui-shadow ui-corner-all ui-icon-arrow-l ui-btn-icon-notext" onclick="goBack()"/></a> 
			<h1>Search</h1>
			<a href="UserSetting.html" class="ui-btn-right ui-btn ui-btn-inline ui-mini ui-corner-all ui-btn-icon-right ui-icon-gear">Options</a> 
      	</div> 
        <!--HEADER END -->

		<div data-role="content" data-theme="a">
			<div>				
				<label>Search</label>
				<!-- <select id = "myList">
				   <option value = "1" onclick="getData()">new release</option>
				   <option value = "2">popular</option>
				   <option value = "3">all</option>
				   <option value = "4">type4</option>
				</select> -->
				<input id="search" type="search" placeholder="Search Key Word" onkeydown="clearCounter()"><br />
			</div>
	 
			<div id="div1" style="display: ;">
				<div id="av"></div>
			</div>
			
			<div class="wrap captionfull" id="container" >
				<script type="text/javascript">
					function getvar()
					{
						var videolist = 'connect to db and then get list';
					}
				</script>
				<script>
					var videoURL = [];
					var videoT = [];
					var videoD = [];
					var videoI = [];
					var mtaJSON;
					
					var searchValue = "";
					var ct = 0;
							
					var timer = setInterval(counterFunction,500);
							
					function counterFunction()
					{
						ct++;
						if(ct == 2)
						{
							sf();
						}
					}
					
					function clearCounter()
					{
						ct = 0;
					}
					
					function sf()
					{	
						document.getElementById("av").innerHTML="";	
						searchValue = document.getElementById("search").value;
						searchFunction();
					}
					
					function goVideoPlayer(videoid) {
					    location.href = "videoComment.html?id="+videoid;
					}//link to video player
					
					function trimByWord(sentence) {
var result = sentence;
var resultArray = result.split(" ");
if(resultArray.length > 29){
resultArray = resultArray.slice(0, 29);
result = resultArray.join(" ") + "â€¦";
}
return result;
}
					
				   	function searchFunction()
					{
						$(document).ready(function() {
								var xmlhttp;
								if (window.XMLHttpRequest)
								{
									// code for IE7+, Firefox, Chrome, Opera, Safari
									xmlhttp=new XMLHttpRequest();
								}
								else
								{
									// code for IE6, IE5
									xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
								}
							
								xmlhttp.open("GET","http://remoteriver.eicp.net/trailercollection/videoinfo.php",true);
								xmlhttp.send();
								var counter =0;
								var lengthInput = 0;
								var lengthTitle = 0;
								xmlhttp.onreadystatechange=function()
						  		{
						  			if (xmlhttp.readyState==4 && xmlhttp.status==200)
								    {
										var getJSON=xmlhttp.responseText;
									
										mtaJSON=jQuery.parseJSON(getJSON);
										
										
										for(var i=0;i<mtaJSON.videos.length-1;i++)
										{
											lengthInput = searchValue.length;
											lengthTitle = mtaJSON.videos[counter].title.length;
											
											if(lengthInput <= lengthTitle)
											{
												compare(searchValue, mtaJSON.videos[counter].title);
											}
											
											function compare(lowLength, highLength)
											{
												
												var searching = highLength.toLowerCase().search(lowLength.toLowerCase());
												
												if(searching != -1)
												{

											//	document.getElementById("av").innerHTML+="<table><tr><td rowspan='2'><a href='' onclick='goVideoPlayer("+mtaJSON.videos[counter].video_id+")'><img src='image/"+mtaJSON.videos[counter].video_id+".jpg'  height='150px'></a></td><td  align='center'><a href='' onclick='goVideoPlayer("+mtaJSON.videos[counter].video_id+")'>"+mtaJSON.videos[counter].title+"</a></td></tr ><tr><td>"+mtaJSON.videos[counter].description+"</td></tr></table>";
												
												document.getElementById("av").innerHTML+="<div class='videolistitem'> <table ><tr><td class='tdimage'> <div class='videolistitemimage'><a href='' onclick='goVideoPlayer("+mtaJSON.videos[counter].video_id+")'><img src='image/"+mtaJSON.videos[counter].video_id+".jpg'  height='150px' width='107px'></a> </div> </td><td><div class='videolistitemtext'>  <div class='videolistitemtitle'><a href='' onclick='goVideoPlayer("+mtaJSON.videos[counter].video_id+")'>"+mtaJSON.videos[counter].title+"</a></div>  <div class='videolistitemdesc'>"+trimByWord(mtaJSON.videos[counter].description)+"</div> </div></td></tr></table> </div>";

												}

											}
											
											//if(mtaJSON.videos[counter].title.toLowerCase() == searchValue.toLowerCase())
											//{
											//	document.getElementById("av").innerHTML+="<a href=''><img src='image/"+mtaJSON.videos[counter].video_id+".jpg'></a>"+mtaJSON.videos[counter].title+ "<br />";
											//}
											
											
											if(i <= (mtaJSON.videos.length-2))
											{
												counter++;
											}
										}//get video id
								  	}
								}		    
							}
						);
					}
				</script>
			</div>
		</div>    
	</body>
</html>
